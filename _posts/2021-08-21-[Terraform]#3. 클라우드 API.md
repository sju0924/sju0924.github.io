---
title: '[terraform]#3. 클라우드 API'
categories: [study]
comments: true
---

# API란?
> 어떤 소프트웨어에서 다른 소프트웨어를 제어하기 위해 미리 약속된 인터페이스

>Application Program interface 의 약자

API를 사용할 때의 장점에는
* 소스 코드의 중복 제거
* 소스 코드의 표준화
* 소스 코드의 재사용성 높임
    * 개발 생산성 향상
* 소프트웨어의 내부 구조를 몰라도 사용 가능

이 있다.

# 웹 API
> 웹 프로토콜을 사용해 네트워크를 통해 호출하는 API

웹상에서 특정 `URI` 에 `HTTP` 등으로 요청을 보내고, 이에 대한 응답으로 필요한 정보를 얻어낸다.

## 웹 API와 HTTP
HTTP는 웹 서버의 HTML 데이터를 웹 브라우저가 받아 화면에 표시하기 위해 정의되었다. 시간이 지나며 HTML 기반의 정적 웹 사이트에서 js,ajax 등의 기술이 도입되면서 점점 동적인 웹 애플리케이션으로 변모되었고, 이러한 기술의 발전 덕분에 웹을 통해 구조적 데이터를 다룰 수 있게 되었다. 때맞춰 여러 대기업들이 자신이 가진 정보를 제3자가 활용할 수 있도록 웹 API를 공개하고 있다.<br>
기업들은 웹 API를 공개하여 개발자들의 참여를 유도해, 다양한 애플리케이션에서 자사의 서비스로 연결하도록 유도해 서비스를 확대하는 성과를 거두고 있다. 최근에는 많은 인기 서비스 업체들이 자신의 서비스 API를 외부에 공개하고 있다. 이러한 기업들 중 대표적인 성공사례가 `아마존` 이다. 아마존은 광고 API를 성공시킨 바가 있었는데, 사용량이 폭주하는 자사 서비스 사이트를 안정적으로 운영하고자 서버나 스토리지 등 컴퓨팅 리소스를 API를 통해 제어할 수 있는 관리 체계를 구축하였다. 이것들이 오늘날 아마존에서 서비스하고 있는 EC2와 S3가 되었다. <br>
이를 웹상에 서비스로 제공하여 웹 API를 통해 사용자가 원하는 시점에 원하는 만큼의 컴퓨팅 리소스를 할당받을 수 있게 한 것을 AWS라고 이 책에서는 보고 있다. 아마존 뿐만 아니라 클라우드 컴퓨팅을 제공하는 대부분의 회사는 마소, 구글 등 인터넷 서비스를 제공하는 기업들인데, 이들이 클라우드 컴퓨팅과 웹 API 기술을 이끌고 있어 클라우드와 웹 API의 관계가 점점 공고해지고 있다. 

## 가상화 기술
웹 API를 통해 가상의 컴퓨팅 리소스를 호출하는 것은 시간을 절약하게 해 주고 편리함을 제공한다. 리소스를 즉시 이용할 수 있게 해 주고 장비를 수배하고 설치하는 시간이 들지 않는다. <br>
한편 IaaS 관점에서는 하드웨어 리소스의 자원 활용도가 높아 리소스를 효율적으로 쓸 수 있다는 면에서 가상화가 필요할 수 있지만 PaaS나 SaaS적 관점에서를 효율적인 리소스 사용보다 성능을 우선할 수도 있어 가상화가 반드시 필요하지는 않다. 따라서, *가상화 기술이 클라우드 컴퓨팅의 본질이라고는 보기 어렵다.* 클라우드 컴퓨팅에서도 성능이나 보안이 더 중요할 경우 가상화된 리소스가 아닌 물리적인 리소스를 직접 사용해야 할 수도 있다.
따라서,
> 클라우드의 본질은 리소스의 가상화 여부가 아니라 인터넷을 통해 필요한 자원을 제어할 수 있는 API 방식에 있다.

## 웹 API 의 구성 요소
웹 API는
* 인증 처리
* 제어할 대상
* 제어 행위

의 3요소로 구성된다. 이는 영문법의 문장 형식을 생각하면 쉽게 이해할 수 있다. `인증 처리`가 주어, `제어할 대상`이 목적어, `제어 행위` 가 동사와 관련된다. 주어, 동사, 목적어에 해당하는 것을 API에서 `액터`, `액션`, `리소스`라 하는데, `액터`를 식별하는 과정이 `인증 처리` 이고, `액션`은 `제어 행위`에 해당하고 웹 API를 하는 것이다. HTTP의 메소드나 헤더를 조합해서 만들어진다. `리소스`는 `제어할 대상`에 해당하고 웹 API의 URI로 표현된다. 선택적으로 보어에 해당하는 `컨디션`이 추가될 수 있는데, 이는 조건을 나타낸다. API에서 정의한 옵션이나 인증 조건 등으로 API를 호출할 때 실행 여부를 제한할 수 있다.

## 리소스
목적어에 해당하고, API 제어 대상이 되는 리소스에 대해 살펴보자. 서버, 스토리지, 네트워크 등의 클라우드 요소들을 리소스라 한다. 이 안에서도, 서버에서는 인스턴스, 이미지, 키 페어 등이 리소스이고 네트워크에서는 라우터, 서브넷, 시큐리니 그룹 등이 리소스이다. 이들은 다룬 리소스와 구분되도록 고유한 식별 키가 필요하다. 이때 사용되는 식별 키에는 두 가지 유형이 있다.
* UUID: 랜덤으로 부여된다. 인스턴스나 서브넷을 생성하면 만들어진다. 특정 리소스를 지정해야 할 때 이를 사용한다.
* 이름: 버킷 안에 들어있는 오브젝트를 지정할 때 버킷 이름과 오브젝트 이름을 사용한다.

이 중 어떤 방식이 사용되는지는 컴포넌트 단위로 결정된다. 해당 컴포넌트 문서를 읽어보면 무엇이 사용되는지 알 수 있다.<br>
리소스 중에서는 고유한 키를 가지는 속성 정보가 있는데, 이것을 `프로퍼티`라고 한다. 예를 들어 인스턴스는 가동 영역, 이미지 ID등 속성 정보가 있고, 이미지도 리소스이기 때문에 이미지 ID와 이와 관련된 인스턴스나 리소스의 정보를 갖고 있다.

## 액션
API 제어 행위에 해당한다. 액션은 리소스에 대해 행하는 동작으로, CRUD 가 대표적이다. API에서 CRUD를 지정할 때는 리소스의 URI를 호출할 때 사용되는 HTTP 메소드와 쿼리 문자열 파라미터 정보를 활용한다. 또한 조회, 수정, 삭제에는 제어 대상을 식별하기 위한 키가 필요하고, 등록은 필요하지 않다.