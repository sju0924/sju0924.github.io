---
title: '[terraform]#4. IT 인프라의 진화와 API 기본 철학'
categories: [study]
comments: true
---

# 서버 구축에 필요한 작업
네트워크는 외부에서 접근 가능한 DMZ 네트워크와 애플리케이션 서버가 위치한 APP 통신용 네트워크, DB 서버가 위치하는 DB 통신용 네트워크가 있다. 웹 서버는 이 중 DMZ와 APP 통신용 네트워크와 연결되어야 하는데, 어떤 순서로 작업해야 할까??

## 가상화 장비로 환경 구축
가상 서버에 리소스를 할당하고, 물리적 호스트의 사양을 선택한다. 사용 가능한 IP주소도 할당해주고 서버를 구동한다. 장비를 발주하고배선, 포트 작업 등이 필요한 물리적 환경에 비해 상대적으로 간단하다. <br>
가장 큰 차이점은 서버의 반입이나 랙에 탑재하는 작업, 캐이블 배선과 같은 물리적인 작업이 필요 없다. 또한 서버를 선택할 때도 구체적인 서버 제품이나 탑재할 모듈 등을 제품 카탈로그를 통해 보고 사양을 선택했지만 가상 환경에서는 할당할 CPU 개수나 메모리 용량을 선택하는 방식으로 바뀌었다. 또한 서버를 랙에 탑재했던 작업은 가상 서버를 물리 서버에 할당하는 방식으로 대체되었다.

## 서버 가상화의 장점과 한계

### 장점
물리적 설치 과정이 필요가 없고 갑작스러운 서버 증설 요구에 대처할 수 있다.

### 한계
물리적 작업이 소프트웨어 작업으로 대체되는 것을 제외하면 그 이전에 필요한 준비 작업의 양은 줄지 않는다. IP 주소 확보, 가상화할 물리 장비 결정, 시스템 설계 등은 가상화 유무와는 상관없이 일정한 작업 시간과 노력이 필요하다. 이들은 사람의 판단과 수적업이 필요하다는 공통점이 있는데, 그렇게 때문에 가상화를 도입해서 작업 효율이 계속해서 향상되다고는 볼 수 없다.

# 클라우드 환경에서의 인프라 구축 작업

## AWS에서
* 서버 사양 선택

인스턴스 유형에 따라 서버 사양에 차이가 있다. 

* 설정 적용

가상 서버가 기동된 직후에 수행되는 설정 작업을 스크립트 형태로 만든 것으로, 최초 기동 시에 일괄 처리하기 위해 만들어진다. 푸가하고 싶은 패키지의 설피나 설정, 각종 서비스의 자동 실행과 같은 내용들이 포함된다.

* 가상 서버 기동
>aws ec2 run-instances 

를 사용하고 옵션으로 인스턴스 유형과 메타 데이터를 지정한다.

## 클라우드 적용 후 변화

클라우드 환경으로 환경을 효율적으로 구축할 수 있다고 했는데, 이런 효율화의 핵심은 위에서도 언급되었던 `사람의 판단과 수작업`을 줄이는 데 있다. 서버 가상화와 클라우드 환경의 작업 방식의 차이를 살펴 보자.

### 가상 서버의 스펙 선택
이전에 CPU 개수나 메모리 용량을 자유롭게 정하다가, 클라우드 환경에서는 선택의 폭을 제한하였다. AWS에서는 인스턴스 유형이 정해져 있다. 꼼꼼하게 리소스의 할당량을 조정할 때 물리적 리소스를 효율적으로 사용할 수는 있겠지만 스펙 검토에 시간과 인건비가 더 들 수 있다. 또 사양을 변경해야 할 때도 재구축하는게 상대적으로 쉽다. 

### 가상 서버를 배치할 호스트의 결정
서버 가상화 환경에서는 인프라 관리자가 가상 서버를 배치할 호스트를 결정했다면 클라우드 환경에서는 가상 서버가 자동으로 배치된다. 사용자들은 이러한 부분을 의식하지 않아도 된다.

### IP 주소의 할당
클라우드 환경에서는 IP 주소 할당도 자동화할 수 있다. 가상 서버를 접속할 네트워크를 선택하면 사용 가능한 IP 주소가 자동으로 확보되어 할당된다. 또한 그가 제거되면 IP주소를 회수하여 재사용한다.<br>
클라우드에서는 동적 DNS와 같은 메커니즘으로 IP 주소를 추상화하기 때문에 동적으로 IP가 할당되더라도 도메인을 통해 연결이 가능해 네트워크 설계에는 큰 문제가 되지 않는다. 

### 설정 스크립트 작성
자동으로 설정 스크립트가 생성된다. 

### 가상 서버 생성 자동화
사버 가상화 환경에서는 템플릿을 복제하여 가상 서버를 만드는 작업과 이후에 이루어지는 환경 설정 작업이 따로 분리되어 있지만 클라우드 환경에서는 이러한 작업들을 연속해서 처리할 수 있다. 템플릿을 복제하여 가상 서버가 기동되면 미리 옵션으로 설정해둔 스크립트를 실행한다. 이러한 일련의 작업들은 하나의 명령을 내리면 내부적으로 여러 API들이 호출되는 형태로 구현되어, 클라우드 API들은 사람이 하는 작업들을 대신하여 작업 효율을 높인다.

## 효율화
이와 같이 클라우드 환경에서는 `사람의 판단과 수작업`을 자동화해 과거 서버 가상화 환경보다 더 효과적으로 작업할 수 있다. 