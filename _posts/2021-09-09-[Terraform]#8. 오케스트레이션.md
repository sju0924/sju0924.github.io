---
title: '[terraform]#8 오케스트레이션'
categories: [study]
comments: true
---

# 1. 오케스트레이션의 기본과 템플릿 구문

## 오케스트레이션과 오토메이션의 개요
DevOps란 개발팀과 운영팀이 협업하며 시스템의 라이프사이클을 고도화하는 기법이다. DevOps의 관점에서 오케스트레이션은 소프트웨어 개발의 자동화를 위해 태스크를 만드는 작업에 해당하고 오토메이션은 CI툴을 사용해서 빌드나 소스 코드 정적 검사를 자동화하는 작업이다. 클라우드에서 오케스트레이션은 클라우드 관리 플랫폼에서 제공하는 리소스 API를 사용해 사람의 판단과 수작업이 필요한 작업을 자동화하는 것이다. 

### Infrastructure as Code

오케스트레이션이나 오토메이션에는 클라우드 인프라나 시스템의 상태를 표현할 때 사람에게 친숙한 텍스트 파일(JSON,YAML 등) 으로 정의한다. 그러면 툴이나 API 등이 이 작업등을 자동으로 처리한다. 이와 같이 클라우드 인프라를 프로그래밍하듯이 텍스트 형태의 코드로 다루는 것을 Infrastructure as Code라고 한다. 이들은 시스템 설정값과 실제 시스템의 상태와 불일치를 줄이기 위해 언제 실행해도 같은 환경이 만들어지도록 되어 있고, 이를 `멱등성`이라 한다. 일반적으로 오케스트레이션 및 오토메이션의 접근 방법은 두 가지 형태로 분류된다.
* 프로그래밍 언어처럼 앱 설치나 설정 순서를 열거하고 이를 자동화하도록 절차형 툴 사용
* 앱에 최정화된 인프라 상태를 템플릿 형태로 정의하고 이를 관리하는 선언형 기능 사용

절차형 툴을 사용하는 접근 방법으로는 Chef나 Puppet, Ansible등을 활용하는 방법이 있다. 이는 구성이나 설정 정보를 관리하는 서버와 그 설정을 적용하는 클라이언트로 구성된다. 서버는 클라이언트의 정보를 참조하며 시스템의 상태를 확인한다. 선언형 툴은 AWS CloudFormation이나 오픈스택 Heat이 있다. 이는 시스템의 리소스들을 하나의 템플릿으로 정의하고 이를 통해 인프라의 프로비저닝을 하도록 만들어져 있다. 선언형 툴이라고는 하지만 클라우드 관리 플랫폼에서 컴포넌트 형태로 구현되어 있기 때문에 툴보다는 기능의 형태로 제공된다고 보는게 맞다. 

### 선언형 툴과 절차형 툴의 적용 범위

시스템이 구축되는 진행 과정은

* 네트워크 및 블록 스토리지 준비
* 이미지로 서버 가동
* OS 설치
* 애플리케이션 설치